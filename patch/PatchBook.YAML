# [PackageDev] target_format: plist, ext: tmLanguage
---
name: PatchBook
scopeName: text.patch
fileTypes: [patch, patchml]

patterns:
- name: constant.patch
  match: (\bVOICE\b)

variables:
  voiceIdentifier: 
  moduleIdentifier: (?!\bVOICE\b)(?<!\S)\w+(?!\S)
  outputModule: ({{moduleIdentifier}})
  label: ([^\(]+(?=\)))
  outputLabel: ({{label}})
  inputModule: ({{moduleIdentifier}})
  inputLabel: ({{label}})
  cvConnector: (\s>>\s)
  pitchConnector: (\sp>\s)
  gateConnector: (\sg>\s)
  triggerConnector: (\st>\s)
  clockConnector: (\sc>\s)
  parameter: (*\s)
  argument: (\[(.*?)\])
  hexNumber: \b(?<!\$)0(x|X)[0-9a-fA-F][0-9a-fA-F_]*\b(?!\$)
  binaryNumber: \b(?<!\$)0(b|B)[01][01_]*\b(?!\$)
  octalNumber: \b(?<!\$)0(o|O)?[0-7][0-7_]*\b(?!\$)
  decimalNumber: |-
    (?<!\$)(?:
      (?:\b[0-9][0-9_]*(\.)[0-9][0-9_]*[eE][+-]?[0-9][0-9_]*\b)| # 1.1E+3
      (?:\b[0-9][0-9_]*(\.)[eE][+-]?[0-9][0-9_]*\b)|             # 1.E+3
      (?:\B(\.)[0-9][0-9_]*[eE][+-]?[0-9][0-9_]*\b)|             # .1E+3
      (?:\b[0-9][0-9_]*[eE][+-]?[0-9][0-9_]*\b)|                 # 1E+3
      (?:\b[0-9][0-9_]*(\.)[0-9][0-9_]*\b)|                      # 1.1
      (?:\b[0-9][0-9_]*(\.)\B)|                                  # 1.
      (?:\B(\.)[0-9][0-9_]*\b)|                                  # .1
      (?:\b[0-9][0-9_]*\b(?!\.))                                 # 1
    )(?!\$)
  anyNumber: ({{hexNumber}})|({{binaryNumber}})|({{octalNumber}})|({{decimalNumber}})

repository:
  statements:
    patterns:
    - include: '#label'
